<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Image Editing - Writeup | CTF-Writeups</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Image Editing - Writeup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here i’ll put all the writeups from CTF challenges that i encounter in CTF websites and competitions" />
<meta property="og:description" content="Here i’ll put all the writeups from CTF challenges that i encounter in CTF websites and competitions" />
<link rel="canonical" href="http://localhost:4000/CTFLearn/Forensics/Image%20Editing/Image%20Editing.html" />
<meta property="og:url" content="http://localhost:4000/CTFLearn/Forensics/Image%20Editing/Image%20Editing.html" />
<meta property="og:site_name" content="CTF-Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Image Editing - Writeup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Here i’ll put all the writeups from CTF challenges that i encounter in CTF websites and competitions","headline":"Image Editing - Writeup","url":"http://localhost:4000/CTFLearn/Forensics/Image%20Editing/Image%20Editing.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=5f9dec9ce37b50ece8caed6050f7c48d838e15b5">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">CTF-Writeups</a></h1>
      

      <h1 id="image-editing---writeup">Image Editing - Writeup</h1>

<h3 id="solve-time-10-mins">Solve Time: ~10 mins</h3>

<h2 id="challenge-description">Challenge Description</h2>
<p>The challenge, <strong>Image Editing</strong>, involves extracting data from an image using various editing and analysis techniques.</p>

<h3 id="challenge-prompt">Challenge Prompt</h3>
<p><img src="https://github.com/user-attachments/assets/2bedce24-515e-4df2-a69a-7c7590c3d2a9" alt="Challenge Prompt" /></p>

<hr />

<h2 id="my-approach-and-thought-process">My Approach and Thought Process</h2>

<h3 id="step-1-initial-inspection">Step 1: Initial Inspection</h3>
<p>I opened the provided <code class="language-plaintext highlighter-rouge">final.png</code> file:</p>

<p><img src="https://github.com/user-attachments/assets/d4915148-aec8-4d04-a709-1380a25a16fa" alt="Opened Image" /></p>
<ul>
  <li>Nothing Important in the metadata</li>
</ul>

<p>There was nothing visually important in the image, so I moved on to metadata analysis using <strong>ExifTool</strong> and <strong>Strings</strong>.</p>

<p><img src="https://github.com/user-attachments/assets/fac0aec4-57c6-41f8-bb77-2ed5ae8654c2" alt="ExifTool Output" /></p>

<p>The <code class="language-plaintext highlighter-rouge">strings</code> output was really long and didn’t reveal anything useful.</p>

<hr />

<h3 id="step-2-checking-for-hidden-data">Step 2: Checking for Hidden Data</h3>
<p>Next, I tried <code class="language-plaintext highlighter-rouge">binwalk</code> and <code class="language-plaintext highlighter-rouge">zsteg</code>:</p>

<p><img src="https://github.com/user-attachments/assets/f2800aac-8684-4d51-af14-9fd91173f037" alt="Binwalk &amp; Zsteg Results" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">binwalk</code> detected a <strong>hidden file</strong>.</li>
  <li><code class="language-plaintext highlighter-rouge">zsteg</code> revealed that there’s a <strong>PNG image hidden inside</strong> the red channel of the original image.</li>
</ul>

<hr />

<h3 id="step-3-extracting-the-hidden-image">Step 3: Extracting the Hidden Image</h3>

<h4 id="using-binwalk"><strong>Using Binwalk</strong></h4>
<p>First, I checked the extracted files:</p>

<p><img src="https://github.com/user-attachments/assets/862f5b9a-6faa-4599-b59d-cdbbf82b6996" alt="Binwalk Extraction" /></p>

<ul>
  <li>One file was empty, and the other was a <strong><code class="language-plaintext highlighter-rouge">.zlib</code></strong> file.</li>
  <li>Running <code class="language-plaintext highlighter-rouge">strings</code> on it gave nothing useful.</li>
</ul>

<p>Since <code class="language-plaintext highlighter-rouge">binwalk</code> didn’t lead to a solution, I returned to <code class="language-plaintext highlighter-rouge">zsteg</code>.</p>

<h4 id="using-zsteg"><strong>Using Zsteg</strong></h4>
<p><img src="https://github.com/user-attachments/assets/48c0472c-30b5-49df-85f6-a6e7b19e9736" alt="image" /></p>

<p>The output included:<br />
<code class="language-plaintext highlighter-rouge">b1,r,lsb,xy</code></p>

<p>Which means:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">b1</code> → <strong>Bit plane 1</strong></li>
  <li><code class="language-plaintext highlighter-rouge">r</code> → <strong>Red color channel</strong></li>
  <li><code class="language-plaintext highlighter-rouge">lsb</code> → <strong>Least Significant Bit</strong></li>
  <li><code class="language-plaintext highlighter-rouge">xy</code> → <strong>Both X and Y directions</strong></li>
</ul>

<p>This confirmed that the hidden image was stored using <strong>LSB steganography</strong> in the <strong>red channel</strong>.</p>

<p>I proceeded with extracting it.</p>

<hr />

<h2 id="my-solution">My Solution</h2>

<p>After extraction, I got the following output:</p>

<p><img src="https://github.com/user-attachments/assets/b75d6686-29e4-46d3-82bb-24ef49b1b5d7" alt="Extracted Image" /></p>

<p>At first, it looked like a corrupted file. However, I noticed the presence of a <strong>PNG header (IHDRM)</strong>—which meant it was an actual image.</p>

<p>I saved it as a new file and opened it:</p>

<p><img src="https://github.com/user-attachments/assets/97d13a9e-8dd3-4f64-aa4a-6972b2808774" alt="Opened Hidden Image" /></p>

<hr />

<h3 id="step-4-analyzing-the-hidden-image">Step 4: Analyzing the Hidden Image</h3>

<p>Looking closely, I noticed something <strong>strange at the top</strong> of the image:</p>

<p><img src="https://github.com/user-attachments/assets/2488cfec-c656-4f4b-9114-4179b6bec88d" alt="Corrupted Top Section" /></p>

<p>I decided to run <code class="language-plaintext highlighter-rouge">exiftool</code>, <code class="language-plaintext highlighter-rouge">strings</code>, and <code class="language-plaintext highlighter-rouge">binwalk</code> again—starting with <code class="language-plaintext highlighter-rouge">exiftool</code>:</p>

<p><img src="https://github.com/user-attachments/assets/46429fa9-6345-4f09-a670-cb57613e91bd" alt="ExifTool Hidden Image" /></p>

<p>The <strong>trailer data after the IEND chunk</strong> indicated <strong>additional hidden data</strong>. So that was a hint to use <code class="language-plaintext highlighter-rouge">zsteg</code> again</p>

<hr />

<h3 id="step-5-running-zsteg-again">Step 5: Running Zsteg Again</h3>

<p>I ran <code class="language-plaintext highlighter-rouge">zsteg</code> on the extracted image:</p>

<p><img src="https://github.com/user-attachments/assets/bc7f6242-1605-4b8e-977e-ca727f3a2a6a" alt="Final Zsteg Output" /></p>

<p>I spotted something that <strong>looked like a flag</strong>, so I wrapped it in <code class="language-plaintext highlighter-rouge">CTFlearn{}</code>:</p>

<hr />

<h2 id="flag--becomes----ctflearn1_kn3w_th3_r3d_w4s_0ff">Flag  Becomes : - <code class="language-plaintext highlighter-rouge">CTFlearn{1_kn3W_tH3_r3D_w4s_0ff}</code></h2>

<hr />

<h2 id="support-the-page-️">Support the Page ❤️</h2>

<p>I hope you enjoyed this writeup! If you want me to keep uploading writeups often, please show your love to the page. Your support keeps me motivated to share more solutions!</p>



      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
