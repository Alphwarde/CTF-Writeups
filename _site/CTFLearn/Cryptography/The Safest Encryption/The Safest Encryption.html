<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The Safest Encryption - Writeup | CTF-Writeups</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="The Safest Encryption - Writeup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here i‚Äôll put all the writeups from CTF challenges that i encounter in CTF websites and competitions" />
<meta property="og:description" content="Here i‚Äôll put all the writeups from CTF challenges that i encounter in CTF websites and competitions" />
<link rel="canonical" href="http://localhost:4000/CTFLearn/Cryptography/The%20Safest%20Encryption/The%20Safest%20Encryption.html" />
<meta property="og:url" content="http://localhost:4000/CTFLearn/Cryptography/The%20Safest%20Encryption/The%20Safest%20Encryption.html" />
<meta property="og:site_name" content="CTF-Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The Safest Encryption - Writeup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Here i‚Äôll put all the writeups from CTF challenges that i encounter in CTF websites and competitions","headline":"The Safest Encryption - Writeup","url":"http://localhost:4000/CTFLearn/Cryptography/The%20Safest%20Encryption/The%20Safest%20Encryption.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=5f9dec9ce37b50ece8caed6050f7c48d838e15b5">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">CTF-Writeups</a></h1>
      

      <h1 id="the-safest-encryption---writeup">The Safest Encryption - Writeup</h1>
<h3 id="solve-time-20-mins">Solve time: ~20 mins</h3>

<h2 id="challenge-description">Challenge description</h2>
<p>The challenge, <em>‚ÄúThe Safest Encryption‚Äù</em>, involves a hidden use of XOR encryption.</p>

<p><strong>Challenge Prompt</strong>:<br />
I intercepted this zip file, and the contents seem to be encrypted, but it looks like the key is also inside. Could you try recovering the encrypted file?</p>

<ul>
  <li><strong>Zip File</strong>: <code class="language-plaintext highlighter-rouge">CTFLearn.zip</code></li>
  <li><strong>Challenge Difficulty</strong>: Medium</li>
  <li><strong>Challenge Points</strong>: 40</li>
</ul>

<hr />

<h2 id="my-approach-and-thought-process">My Approach and Thought Process</h2>

<ol>
  <li>
    <p><strong>Initial Inspection</strong><br />
I started by unzipping <code class="language-plaintext highlighter-rouge">CTFLearn.zip</code>, which revealed two files: <code class="language-plaintext highlighter-rouge">CTFLearn.pdf</code> and <code class="language-plaintext highlighter-rouge">CTFLearn.txt</code>.</p>

    <p><img src="https://github.com/user-attachments/assets/1979d10a-d015-461c-a12d-5e0939d83fb4" alt="Unzipped Files" /></p>
  </li>
  <li>
    <p><strong>Checking the Files‚Äô Usability</strong><br />
I tried opening both files, but neither worked. I used the <code class="language-plaintext highlighter-rouge">file</code> command to inspect their formats.</p>

    <p><img src="https://github.com/user-attachments/assets/069977eb-9aca-4aa3-be17-fdd7a8294569" alt="File Command Result" /></p>
  </li>
  <li>
    <p><strong>Fixing the File Headers</strong><br />
After checking the files, I suspected that the file headers might be incorrect. I began by fixing the header of the <code class="language-plaintext highlighter-rouge">.pdf</code> file. The magic bytes for a PDF file should be <code class="language-plaintext highlighter-rouge">25 50 44 46 2D</code>.</p>

    <p>Before fixing the header:<br />
<img src="https://github.com/user-attachments/assets/485c0a8c-5b24-4dc3-85d4-03a563d4da2c" alt="Original PDF Header" /></p>

    <p>After fixing the header:<br />
<img src="https://github.com/user-attachments/assets/b32b5f7a-4804-4693-a45d-778605088bc4" alt="Fixed PDF Header" /></p>
  </li>
  <li>
    <p><strong>Opening the Fixed PDF</strong><br />
Even after fixing the header, the PDF wouldn‚Äôt open. This led me to believe the PDF was either empty or just a red herring in the challenge.</p>
  </li>
  <li>
    <p><strong>Analyzing the Challenge Name</strong><br />
Given the name of the challenge, I initially thought it could be related to AES encryption, but after testing it with no results, I decided to investigate further using the provided files.</p>
  </li>
  <li>
    <p><strong>Looking for Clues</strong><br />
I ran <code class="language-plaintext highlighter-rouge">wc</code> (word count) on both files to check their byte size.</p>
  </li>
</ol>

<p>wc CTFLearn.pdf 
113 565 24065 CTFLearn.pdf</p>

<p>wc CTFLearn.txt
79 547 24065 CTFLearn.txt</p>

<p>Both files had the same number of bytes (<code class="language-plaintext highlighter-rouge">24065</code>), indicating they might be related.</p>

<ol>
  <li><strong>Verifying the Identical Files with <code class="language-plaintext highlighter-rouge">xxd</code></strong><br />
I ran <code class="language-plaintext highlighter-rouge">xxd</code> on both files to examine their content. The output showed identical, seemingly random binary data.</li>
</ol>

<p><img src="https://github.com/user-attachments/assets/a12a40f6-9aab-4610-a4c4-0b54e199f0f7" alt="xxd output" /></p>

<p><img src="https://github.com/user-attachments/assets/59a2dcd9-f951-465c-b902-eb30f309948f" alt="xxd output 2" /></p>

<hr />

<h2 id="the-solution">The Solution</h2>

<p>Based on my observations, I deduced that the two files were XORed with each other, likely because the encryption key is the same length as the data itself.</p>

<h3 id="xor-decryption-code"><strong>XOR Decryption Code</strong></h3>

<p>I wrote a simple Python script to XOR the two files together:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">file1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">"CTFlearn.pdf"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">).</span><span class="n">read</span><span class="p">())</span>  
<span class="n">file2</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">"CTFlearn.txt"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">).</span><span class="n">read</span><span class="p">())</span>  

<span class="n">xord_byte_array</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">file1</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">file1</span><span class="p">)):</span>
 <span class="n">xord_byte_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">file1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">file2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"output.pdf"</span><span class="p">,</span> <span class="s">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_file</span><span class="p">:</span>
 <span class="n">out_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">xord_byte_array</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"done"</span><span class="p">)</span>
</code></pre></div></div>
<p>Result:</p>
<ul>
  <li>After running the script, I checked the resulting output.pdf and found the flag inside.
<img src="https://github.com/user-attachments/assets/008d2cd2-ea29-4d1d-9ff5-da901dad801c" alt="image" /></li>
  <li>Also after solving it through this script i found a tool called <code class="language-plaintext highlighter-rouge">XORfiles</code></li>
  <li><img src="https://github.com/user-attachments/assets/12448cb8-e40b-4a8a-8794-9f34878a6c29" alt="image" /></li>
</ul>

<h1 id="the-flag">The Flag:</h1>
<h3 id="ctflearnctflearn_is_fun_hope_you_enjoyed_it">CTFlearn{CTFlearn_is_fun_hope_you_enjoyed_it!}</h3>

<h3 id="i-hope-this-writeup-helped-you-understand-the-solution-to-the-challenge-the-key-was-recognizing-the-xor-encryption-and-understanding-that-both-files-were-the-same-length-and-likely-encrypted-using-xor-if-you-found-this-writeup-helpful-feel-free-to-show-your-appreciation-so-i-can-continue-creating-writeups-like-this-thanks-for-reading-and-for-your-time-">I hope this writeup helped you understand the solution to the challenge! The key was recognizing the XOR encryption and understanding that both files were the same length and likely encrypted using XOR. If you found this writeup helpful, feel free to show your appreciation so I can continue creating writeups like this. Thanks for reading and for your time! üíñ</h3>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
