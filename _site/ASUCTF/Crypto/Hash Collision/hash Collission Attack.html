<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hash Collision Attack - Writeup | CTF-Writeups</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Hash Collision Attack - Writeup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here i’ll put all the writeups from CTF challenges that i encounter in CTF websites and competitions" />
<meta property="og:description" content="Here i’ll put all the writeups from CTF challenges that i encounter in CTF websites and competitions" />
<link rel="canonical" href="http://localhost:4000/ASUCTF/Crypto/Hash%20Collision/hash%20Collission%20Attack.html" />
<meta property="og:url" content="http://localhost:4000/ASUCTF/Crypto/Hash%20Collision/hash%20Collission%20Attack.html" />
<meta property="og:site_name" content="CTF-Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hash Collision Attack - Writeup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Here i’ll put all the writeups from CTF challenges that i encounter in CTF websites and competitions","headline":"Hash Collision Attack - Writeup","url":"http://localhost:4000/ASUCTF/Crypto/Hash%20Collision/hash%20Collission%20Attack.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=5f9dec9ce37b50ece8caed6050f7c48d838e15b5">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">CTF-Writeups</a></h1>
      

      <h2 id="hash-collision-attack---writeup">Hash Collision Attack - Writeup</h2>
<h3 id="solve-time-1hr-40mins-was-trying-to-generate-a-collision-attack-from-the-original-hashes-for-over-1hour--">Solve time: 1hr 40mins {was trying to generate a collision attack from the original hashes for over 1hour :)))))) }</h3>
<h2 id="challenge-description">Challenge Description</h2>

<p>The challenge presented, titled “Hash collision attack,” involved exploiting a vulnerability related to hashing algorithms. The challenge included the following components:</p>

<ul>
  <li><strong>Challenge Prompt:</strong>  The hash was generated using a common hashing algorithm, and the username and salt are available to you. 
Your task is to crack the original password and then log in to the website.
Once logged in, you’ll be required to provide two different strings that hash to the same value, Has exploiting a hash collision.
Successfully submitting these two strings will grant you the flag.</li>
  <li><strong>Note:</strong>  The challenge description included a note stating that this scenario simulates a real-world attack where hash collisions are used to bypass security measures.</li>
  <li><strong>Website Link:</strong>  A standard login page was provided, requiring the username “GRC” and the unknown password.</li>
  <li><strong>Python File:</strong> A Python script was provided, outlining the hashing process.</li>
</ul>

<h2 id="the-login-page">The login page</h2>
<p><img src="https://github.com/user-attachments/assets/f7972fee-d762-4fef-8f2b-bd3683d2cb97" alt="image" />
and this is the python script provided:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">username</span> <span class="o">=</span> <span class="s">"GRC"</span>
<span class="n">password</span> <span class="o">=</span> <span class="s">"[Redacted]"</span>
<span class="n">salt</span> <span class="o">=</span> <span class="s">"coll"</span>

<span class="n">combined</span> <span class="o">=</span> <span class="n">salt</span> <span class="o">+</span> <span class="n">password</span>

<span class="n">hashed</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">combined</span><span class="p">.</span><span class="n">encode</span><span class="p">()).</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">"MD5 hash with salt:"</span><span class="p">,</span> <span class="n">hashed</span><span class="p">)</span>
<span class="c1"># MD5 hash with salt: 3ac226cead2ac3b22c0fbe93d455c89f
</span></code></pre></div></div>

<h3 id="solution-and-approach">Solution and Approach</h3>

<p>The first step in addressing the challenge was to analyze the provided Python file. This script reveals the use of the <code class="language-plaintext highlighter-rouge">hashlib</code> library and the <code class="language-plaintext highlighter-rouge">md5</code> hashing algorithm. The <code class="language-plaintext highlighter-rouge">salt</code> variable is set to “coll.” The process involves concatenating the <code class="language-plaintext highlighter-rouge">salt</code> with the <code class="language-plaintext highlighter-rouge">password</code> and then generating the MD5 hash. The comment at the end of the script provides the target hash value: <code class="language-plaintext highlighter-rouge">3ac226cead2ac3b22c0fbe93d455c89f</code>.
And also looking at the salt being called “coll” i remembered a github tool called <code class="language-plaintext highlighter-rouge">coll</code></p>

<p>To recover the original password, a brute-force approach was employed. This method involves systematically trying different passwords and comparing the resulting salted hash with the target hash. A common wordlist used for this purpose is <code class="language-plaintext highlighter-rouge">rockyou.txt</code>.</p>
<ul>
  <li>rockyou.txt is a wordlist for common password
The following script was used to perform the brute-force attack:</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">salt</span> <span class="o">=</span> <span class="s">"coll"</span>
<span class="n">target_hash</span> <span class="o">=</span> <span class="p">[</span><span class="s">"3ac226cead2ac3b22c0fbe93d455c89f"</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">check_password</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
    <span class="n">combined</span> <span class="o">=</span> <span class="n">salt</span> <span class="o">+</span> <span class="n">password</span>
    <span class="n">hashed</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">combined</span><span class="p">.</span><span class="n">encode</span><span class="p">()).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">hashed</span> <span class="ow">in</span> <span class="n">target_hash</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"rockyou.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">check_password</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Found password: </span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">break</span>
</code></pre></div></div>

<p>This script reads each line from the <code class="language-plaintext highlighter-rouge">rockyou.txt</code> file, treats it as a potential password, prepends the salt, calculates the MD5 hash, and checks if it matches the target hash. The <code class="language-plaintext highlighter-rouge">errors='ignore'</code> parameter handles potential decoding issues in the wordlist. Executing this script revealed the password to be <code class="language-plaintext highlighter-rouge">passpasspassthrough</code>.</p>

<p>With the password recovered, it was possible to log in to the provided website using the username “GRC” and the identified password.</p>

<p><img src="https://github.com/user-attachments/assets/cfd2ef9b-b004-4a81-80d2-663f9f9b3b05" alt="image" /></p>

<p>The second part of the challenge required identifying two distinct strings that produce the same MD5 hash, demonstrating a hash collision. Discovering such collisions for MD5 manually can be computationally intensive. so, publicly known examples of MD5 collisions were the choice. I found that the strings “TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak” and “TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak” are known to produce the same MD5 hash value in certain contexts if using a certain salt+password suffix or prefix.</p>

<p><img src="https://github.com/user-attachments/assets/d8f14859-0a5d-40f6-be55-aa712268dbce" alt="image" /></p>

<p>Submitting these two strings on the website solved the challenge,resulting in the flag.</p>

<p><img src="https://github.com/user-attachments/assets/6a5529c9-47a7-4311-84af-3c59ae09c512" alt="image" />
Flag is : ASU{hash_collision_found_https://x.com/realhashbreaker/status/1770161965006008570_Successfully!!!}</p>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
